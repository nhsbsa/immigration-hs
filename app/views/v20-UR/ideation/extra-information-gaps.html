{% extends "layout-health.html" %}

{% block pageTitle %}
Extra information
{% endblock %}

{% block beforeContent %}
<div class="govuk-phase-banner">
  <p class="govuk-phase-banner__content">
    <span class="govuk-phase-banner__text">
      Your <a class="govuk-link" href="https://wh1.snapsurveys.com/SURVEY_PREVIEW.asp?k=162645215363">feedback (opens in new tab)</a> will help us to improve this service.
    </span>
  </p>
</div>
<a class="govuk-back-link" href="javascript:window.history.back()">Back</a>
{% endblock %}

{% block content %}
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add extra information</title>
  <style>
    .hidden {
      display: none;
    }
  </style>
</head>

<body>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <form class="form" action="/v20-ur/check-your-answers-gaps" method="post">
        <div class="govuk-form-group">
          
          <h1 class="govuk-heading-l">
            <span class="govuk-caption-l">Application</span>
            Add extra information for this application (optional)
          </h1>


          <div class="govuk-notification-banner" role="region" aria-labelledby="govuk-notification-banner-title"
            data-module="govuk-notification-banner">
            <div class="govuk-notification-banner__header">
              <h2 class="govuk-notification-banner__title" id="govuk-notification-banner-title">
                Gaps in payslips
              </h2>
            </div>
            <div class="govuk-notification-banner__content">
              <p>You have not uploaded payslips covering every day of this claim. You need to upload alternative
                evidence to explain the gaps.</p>
              <p>
              <dl class="govuk-summary-list" style="margin-top: -15px; margin-bottom: -10px;">
                <div class="govuk-summary-list__row">
                  <dt class="govuk-summary-list__key">
                    April 2020
                  </dt>
                  <dd class="govuk-summary-list__value">
                    <a href="april-add-ur">Upload payslips for April 2020</a>
                  </dd>
                </div>

              </dl>



              </p>
            </div>
          </div>
          <p>Add extra information to explain any gaps in the applicant's employment or evidence.</p>


          <h2 class="govuk-heading-m">Gaps in evidence or employment</h2>

          <p> The applicant may have gaps in their evidence because they were:</p>

          <ul class="govuk-list govuk-list--bullet">

            <li> paid in arrears for the first month in their role and they do not have payslips for that time</li>
            <li>on maternity or paternity leave</li>
            <li>furloughed due to COVID-19</li>
            <li>on sick leave or self-isolating</li>

          </ul>

          <p>To cover any gaps, you need to upload a signed letter from the applicant's employer confirming the reasons
            and exact dates of the gaps.
          </p>

          <h2 class="govuk-heading-m">Other details</h2>

          <p>You can also include other details that will help us process this application.</p>


    



          <p>For example, if the applicant's name has changed, you should upload evidence that the name in the application and the name on the payslips and contract uploaded are the same person. This could be a marriage certificate or a letter from the applicant's employer confirming that they use a different name at work.
          </p>




          <h2 class="govuk-heading-m">Extra information</h2>

          <p>Include as much detail as possible.</p>
          <!-- <div class="govuk-warning-text" style="margin-top:30px;">
            <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
            <strong class="govuk-warning-text__text">
              <span class="govuk-warning-text__assistive">Warning</span>
              Do not include personal or financial information, like a National Insurance number or credit card details.            </strong>
          </div> -->
          <!-- <label class="govuk-label govuk-label--m" for="file-upload-1">
           Extra information
          </label> -->
          <textarea class="govuk-textarea govuk-js-character-count" id="with-hint" name="with-hint" rows="5"
            aria-describedby="with-hint-info with-hint-hint">{{ data['with-hint']}}</textarea>
        </div>
        <div id="with-hint-info" class="govuk-hint govuk-character-count__message" aria-live="polite">
          You can enter up to 2000 characters
        </div>
        <br>

        <label class="govuk-label govuk-label--m" for="documents">
          Upload evidence for your extra information
        </label>
        <p>Files must:</p>
        <ul class="govuk-list govuk-list--bullet">

          <li>be clear and readable</li>
          <li>be in JPG, JPEG, BMP, PNG or PDF format</li>
          <li>be smaller than 2MB each</li>
        </ul>
  
          

          <!-- Section for uploaded files -->

          <div id="content-to-hide">
          <div id="uploaded-files-container" class="hidden">
            <label class="govuk-label govuk-label--m" for="documents">
              Files uploaded
            </label>
            <p>
              Select 'preview' to check the files you've uploaded (previewed files will open in a new tab) or select 'delete' to remove files from this application.
            </p>
            <div id="uploaded-files" class="govuk-summary-list moj-multi-file-upload__list"></div>
          </div>

          <!-- File upload input -->
          <div id="file-upload-container" class="moj-multi-file-upload">
            <label class="govuk-label govuk-label--m" for="documents">Upload files</label>
            
            <input
              class="govuk-file-upload moj-multi-file-upload__input"
              id="documents"
              name="documents"
              type="file"
              multiple
            />
          </div>

        </div>

          <!-- Warning text for missing payslips -->
          <div id="content-to-show" class="hidden">
            
          </div>

          <!-- Checkbox -->
          

          <button class="govuk-button" data-module="govuk-button">Continue</button>
        </div>
      </form>
    </div>
  </div>
  
  <script>
    function toggleContent() {
      var checkbox = document.getElementById('toggle-checkbox');
      var contentToHide = document.getElementById('content-to-hide');
      var contentToShow = document.getElementById('content-to-show');

      if (checkbox.checked) {
        contentToHide.classList.add('hidden');
        contentToShow.classList.remove('hidden');
      } else {
        contentToHide.classList.remove('hidden');
        contentToShow.classList.add('hidden');
      }
    }

    // Initialize the state on page load based on the checkbox state
    document.addEventListener('DOMContentLoaded', function () {
      toggleContent();
    });
  </script>
  <script>
    // Toggles content visibility when checkbox is clicked
    

    // Handles file upload functionality
    document.addEventListener('DOMContentLoaded', function () {
      const fileInput = document.getElementById('documents');
      const uploadedFilesContainer = document.getElementById('uploaded-files-container');
      const fileListContainer = document.getElementById('uploaded-files');

      fileInput.addEventListener('change', function () {
        if (fileInput.files.length > 0) {
          uploadedFilesContainer.classList.remove('hidden'); // Show the uploaded files section
        } else {
          uploadedFilesContainer.classList.add('hidden'); // Hide if no files
        }

        fileListContainer.innerHTML = ''; // Clear the list

        // Iterate through the selected files
        Array.from(fileInput.files).forEach((file, index) => {
          const fileRow = document.createElement('div');
          fileRow.className = 'govuk-summary-list__row moj-multi-file-upload__row';

          // File details
          const fileDetails = `
            <dd class="govuk-summary-list__value moj-multi-file-upload__message">
              <span class="moj-multi-file-upload__success">
                <svg class="moj-banner__icon" fill="currentColor" role="presentation" focusable="false"
                  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" height="25" width="25">
                  <path d="M25,6.2L8.7,23.2L0,14.1l4-4.2l4.7,4.9L21,2L25,6.2z"></path>
                </svg>Payslip ${file.name} successfully uploaded
              </span>
            </dd>
          `;

          // Actions (Preview and Delete)
          const actions = `
            <dd class="govuk-summary-list__actions">
              <ul class="govuk-summary-list__actions-list">
                <li class="govuk-summary-list__actions-list-item">
                  <a class="govuk-link" href="/public/images/employer-letter.pdf" target="_blank" style="font-size: 16px;">Preview</a>
                </li>
                <li class="govuk-summary-list__actions-list-item">
                  <a class="govuk-link" href="extra-information-delete"  style="font-size: 16px;">Delete</a>
                </li>
              </ul>
            </dd>
          `;

          fileRow.innerHTML = fileDetails + actions;
          fileListContainer.appendChild(fileRow);

          // Add event listener for delete functionality
          fileRow.querySelector('[data-index]').addEventListener('click', function () {
            removeFile(index);
          });
        });
      });

      // Remove file from input and update the display
      function removeFile(index) {
        const dataTransfer = new DataTransfer();
        Array.from(fileInput.files).forEach((file, i) => {
          if (i !== index) {
            dataTransfer.items.add(file);
          }
        });

        fileInput.files = dataTransfer.files;
        fileInput.dispatchEvent(new Event('change')); // Trigger the change event to update the UI
      }
    });
  </script>
</body>

</html>
{% endblock %}
