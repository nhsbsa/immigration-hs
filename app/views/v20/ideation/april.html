{% extends "layout-health.html" %}

{% block pageTitle %}
IHS question
{% endblock %}

{% block beforeContent %}
<div class="govuk-phase-banner">
  <p class="govuk-phase-banner__content">
    <span class="govuk-phase-banner__text">
      Your <a class="govuk-link" href="https://wh1.snapsurveys.com/SURVEY_PREVIEW.asp?k=162645215363">feedback (opens in new tab)</a> will help us to improve this service.
    </span>
  </p>
</div>
<a class="govuk-back-link" href="javascript:window.history.back()">Back</a>
{% endblock %}

{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>File Upload</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/govuk-frontend@4.6.0/govuk-frontend.min.css">
  <script src="https://cdn.jsdelivr.net/npm/govuk-frontend@4.6.0/govuk-frontend.min.js" defer></script>
  <style>
    .drop-zone {
      border: 2px dashed #0b0c0c;
      padding: 20px;
      text-align: center;
      margin-top: 1em;
      cursor: pointer;
    }

    .drop-zone.drag-over {
      background-color: #f3f2f1;
      border-color: #1d70b8;
    }

    .uploaded-file {
      margin-top: 1em;
      padding: 10px;
      border-left: 5px solid #00703c;
      background: #f3f2f1;
    }
  </style>
</head>
<body class="govuk-template__body">
<script>window.GOVUKFrontend.initAll()</script>

<main class="govuk-main-wrapper govuk-!-padding-top-4">
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <h1 class="govuk-heading-l">Upload payslips</h1>

      <div id="uploaded-files" class="govuk-body"></div>

      <div id="drop-zone" class="drop-zone">
        Drag and drop files here or
        <label for="file-upload" class="govuk-button govuk-button--secondary">Choose files</label>
        <input id="file-upload" name="files" type="file" multiple class="govuk-visually-hidden">
      </div>

    </div>
  </div>
</main>

<script>
  const dropZone = document.getElementById('drop-zone');
  const fileInput = document.getElementById('file-upload');
  const uploadedFilesContainer = document.getElementById('uploaded-files');

  function handleFiles(files) {
    Array.from(files).forEach(file => {
      const fileBox = document.createElement('div');
      fileBox.className = 'uploaded-file';
      fileBox.innerHTML = `<strong>${file.name}</strong> successfully uploaded. <a href="#">Delete</a>`;
      uploadedFilesContainer.appendChild(fileBox);
    });
  }

  fileInput.addEventListener('change', () => {
    handleFiles(fileInput.files);
  });

  dropZone.addEventListener('dragover', (e) => {
    e.preventDefault();
    dropZone.classList.add('drag-over');
  });

  dropZone.addEventListener('dragleave', () => {
    dropZone.classList.remove('drag-over');
  });

  dropZone.addEventListener('drop', (e) => {
    e.preventDefault();
    dropZone.classList.remove('drag-over');

    const droppedFiles = e.dataTransfer.files;
    if (!droppedFiles.length) return;

    // Mirror the drop into the input
    const dataTransfer = new DataTransfer();
    Array.from(droppedFiles).forEach(file => dataTransfer.items.add(file));
    fileInput.files = dataTransfer.files;

    // Trigger change event
    fileInput.dispatchEvent(new Event('change', { bubbles: true }));
  });
</script>
</body>
</html>

{% endblock %}
